Queries for Project 1/*Query 1 for Question 1 */WITH t1 AS 	(SELECT	f.title  	 ,c.name    	,r.rental_dateFROM film fJOIN film_category fc	ON f.film_id=fc.film_idJOIN category c	ON fc.category_id=c.category_idJOIN inventory i	ON f.film_id=i.film_idJOIN rental r	ON i.inventory_id=r.inventory_idWHERE c.name IN('Animation'               ,'Children'               ,'Classics'               ,'Comedy'               ,'Family'               ,'Music')SELECT	 t2.category	,SUM(t2.rental_count) total_rentalsFROM	(SELECT		 t1.title	,t1.name category    	,COUNT(t1.title) AS rental_countFROM t1GROUP BY t1.title, t1.nameORDER BY category, rental_count DESC)t2GROUP BY t2.category;/*Query 2 for Question 2*/SELECT	t1.title    ,t1.name category    ,t1.rental_duration    ,NTILE (4) OVER (ORDER BY t1.rental_duration)AS standard_quartileFROM 	(SELECT *	FROM film f	JOIN film_category fc		ON f.film_id=fc.film_id	JOIN category c		ON fc.category_id=c.category_id	WHERE c.name IN('Animation'                ,'Children'                ,'Classics'                ,'Comedy'                ,'Family'                ,'Music'))t1 /*Query 3 for Question 3*/	SELECT	    t2.category    ,t2.standard_quartile    , COUNT(standard_quartile) AS countFROM	(SELECT    	t1.name category    	,NTILE (4) OVER (ORDER BY 	t1.rental_duration)AS standard_quartile	FROM (SELECT *	FROM film f	JOIN film_category fc		ON f.film_id=fc.film_id	JOIN category c		ON fc.category_id=c.category_id	WHERE c.name IN('Animation'                ,'Children'                ,'Classics'                ,'Comedy'                ,'Family'                ,'Music'))t1 ) t2GROUP BY t2.category, t2.standard_quartileORDER BY t2.category, t2.standard_quartile;/*Query 4 for Question 4*/SELECT t1.rental_month	,t1.rental_year    ,t1.store_id    ,COUNT(t1.rental_count) AS rental_countFROM(SELECT DATE_PART('month', r.rental_date) AS rental_month	,DATE_PART('year', r.rental_date) AS rental_year   ,i.store_id   ,COUNT(i.inventory_id) OVER (PARTITION BY DATE_PART('month',rental_date) ORDER BY i.store_id) AS rental_countFROM rental rJOIN inventory iON r.inventory_id=i.inventory_id)t1GROUP BY t1.rental_month, t1.rental_year, t1.store_idORDER BY COUNT(t1.rental_count) DESC